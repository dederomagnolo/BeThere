<!DOCTYPE html>

<head>
    <title>BeThere</title>    
    
    <meta charset="utf-8">
    <!--<link rel="icon" href="favicon.png">-->
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:700">
    
    <!--menu-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="navigation-dark.css">
    <link rel="stylesheet" href="slicknav.min.css">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
    
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
</head>


<body>
    
    <main>
        
        <div id="dashboard">
            <h1>Dashboard</h1>

            <div class="container">
                
                <div class="soil">
                    <p>Soil Moisture </p>
                    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/695672/widgets/39942"></iframe>
                </div>
                
                <div class="luminosity">
                    <p>Luminosity</p>
                    
                        <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/695672/widgets/63648"></iframe>
  
                </div>          
                
                <aside class="weather-box">
                    <a class="weatherwidget-io" href="https://forecast7.com/en/n22d01n47d89/sao-carlos/" data-label_1="SÃO CARLOS" data-label_2="WEATHER" data-theme="gray" >SÃO CARLOS WEATHER</a>
                <script>
                !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
                </script>
                
                </aside>               

            </div>        
        </div>
        
        <div id="charts">
            
            <h1>Charts</h1>
                <div class="graph1-moisture">
                    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/695672/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&title=Soil+Moisture&type=line"></iframe>
                </div>
                
                <div class="graph2-temperature">
                    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/695672/charts/4?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&title=Temperature&type=line"></iframe>
                </div>
            
                <div class="graph3-umidity">
                    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/695672/charts/3?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&title=Relative+Humidity&type=line"></iframe>
                </div>
            
                <div class="graph4-luminosity">
                    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/695672/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&title=Luminosidade&type=line"></iframe>
                </div>
        </div>
        
        <div id="books">            
            <h1>Library</h1>            
            <div class="container">
                
                <p>Full sun. 6+ hours of direct sunlight.
                    Partial sun. 4-5 hours of direct sunlight.
                    Partial shade. 2-4 hours of direct sunlight.
                    Shade Less than 1 hour of direct sunlight.</p>
            </div>        
        </div>
        
        
        <div id="settings">
            
            <h1>Settings</h1>

            <div class="container modes">
            <h2>Operation Mode</h2>
                <button type="button" id="timer-on" class="button button3" >Timer</button>
                <button type="button" id="umidity-on" class="button button4" >Umidity</button>
            </div>
            
            <div class="timers" id="TimerOptions">
                <h2>Set timer</h2>
                
                <button type="button" id="6hours" class="button button5" >6h</button>  
                <button type="button" id="8hours" class="button button6" >8h</button>
                <button type="button" id="12hours" class="button button7" >12h</button>
                <button type="button" id="16hours" class="button button8" >16h</button>
                <button type="button" id="24hours" class="button button9" >24h</button>
                
                <div>
                    <h3><span>Temperature: <span id="tempValueSpan"></span>ºC </span> </h3><span><input type="text" id="tempValue" placeholder="insert the temperature"/input></span>
                    <button type="button" id="send" class="button">SEND</button>
                </div>
                    
            </div>
            <div class="container modes" id="UmidityOptions">
                <h2>UMIDITY MODE ON!</h2>
                <p>Running in umidity mode, the timer mode is offline. Click in "Timer"
                   to switch off umidity mode and use timer. </p>
            </div>            
        </div>
            
        
    </main>
    
    <div class="logo-imagem">
        <img src="teste2.png" alt="logo - Be There" border="2" style="width:203px;height:128px;">
    </div>
    
    <!--<footer class="rodape-pagina">
        <!--&copy; Be There-->
        
        <!--Menu Inferior-->
        
        <!--&copy; Be There - 2019
    </footer>-->   
    
    <nav class="menu-navigation-dark">
            
            <a href="#dashboard" class="selected" onclick="mostrar('dashboard');ocultar('charts');ocultar('books');ocultar('settings');"><i class="fa fa-th-list"></i><span>Dashboard</span></a>
            <a href="#charts" onclick="mostrar('charts');ocultar('dashboard');ocultar('books');ocultar('settings');"><i class="fa fa-bar-chart"></i><span>Charts</span></a>
            <a href="#books" onclick="mostrar('books');ocultar('charts');ocultar('dashboard');ocultar('settings');" ><i class="fa fa-book"></i><span>Library</span></a>
            <a href="#settings" onclick="mostrar('settings');ocultar('dashboard');ocultar('books');ocultar('charts');"><i class="fa fa-gear"></i><span>Settings</span></a>
            
        </nav>
        
        <!--onclick="funcao_a();funcao_b();"-->

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="jquery.slicknav.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


        <script>        
        
        var umidade = 1;
        var timer = 0;

                $("#timer-on").click(function(){
                    $("#UmidityOptions").hide();
                    $("#TimerOptions").show();
                });
    
                $("#umidity-on").click(function(){
                    $("#UmidityOptions").show();
                    $("#TimerOptions").hide();
                });

            $(function(){

                var menu = $('.menu-navigation-dark');

                menu.slicknav();

                // Mark the clicked item as selected

                menu.on('click', 'a', function(){
                    var a = $(this);

                    a.siblings().removeClass('selected');
                    a.addClass('selected');
                });
            });
            
            function  mostrar(ID){
	           document.getElementById(ID).style.display = "block";

            }

            function  ocultar(ID){
                document.getElementById(ID).style.display = "none";
                $("#dive").hide("slow");
            }

            function alterMode(){
            }
        
        document.getElementById('umidity-on').addEventListener('click', function() {
                var url = "http://api.thingspeak.com/update?api_key=ZY113X3ZSZG96YC8&field6=0"
                alert("Umidity Mode ON");
                $.getJSON(url, function(data) {
                    console.log(data);
                });
        });

        
        document.getElementById('timer-on').addEventListener('click', function() {
                var url = "http://api.thingspeak.com/update?api_key=ZY113X3ZSZG96YC8&field6=1"
                alert("Timer Mode ON");
                $.getJSON(url, function(data) {
                    console.log(data);
                });
        });

        // Função para envio de uma nova temperatura        
        document.getElementById('send').addEventListener('click', function() {
            var temperatureSend = document.getElementById('tempValue').value ;
               var url = "http://api.thingspeak.com/update?api_key=ZY113X3ZSZG96YC8&field5="+temperatureSend
               alert("Temperature Send: "+temperatureSend);
               $.getJSON(url, function(data) {
                location.reload("#settings");
                   console.log(data);
               });
       });

       // Função para leiura da variavel de temperatura na API (ultima temperatura enviada)
       $.getJSON('https://api.thingspeak.com/channels/695672/field/5/last.json?apikey=QVBH04I290VRXEOL', function(data) {          
            dataField5 = data.field5;
            if (dataField5) {
                // $('#tempValueSpan').val(dataField5);
                document.getElementById('tempValueSpan').innerHTML = dataField5;
            }          
        });

        // Leitura da API para receber ultima "posição" do tipo de modo ativo
       $.getJSON('https://api.thingspeak.com/channels/695672/field/6/last.json?apikey=QVBH04I290VRXEOL', function(data) {          
            dataField6 = data.field6;
            if (dataField6 == 1) {
                timer = 1; // Timer ativa
                umidade = 0; // Umidade desativada
                    console.log("Timer Ativo - Umidade Desativada");
                    $("#TimerOptions").show();
                    $("#UmidityOptions").hide();
            } else {
                timer = 0;  // Timer desativado
                umidade = 1; // Umidade ativa
                    console.log("Umidade Ativada - Timer Desativado");  
                    $("#UmidityOptions").show();
                    $("#TimerOptions").hide();  
            }                    
        });
        
    </script>
</body>